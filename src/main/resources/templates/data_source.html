<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../static/css/index.css">
    <link rel="stylesheet" href="https://unpkg.com/vue-prism-editor/dist/prismeditor.min.css"/>
    <link rel="stylesheet" href="https://unpkg.com/prismjs/themes/prism-tomorrow.css"/>
    <link rel="stylesheet" href="../static/css/contextMenu.min.css"/>
    <title>数据源</title>
</head>
<body>
<div id="app">
    <el-container>
        <el-header height="100px">
            <el-menu
                    :default-active="activeIndex"
                    class="el-menu-demo"
                    mode="horizontal"
            >
                <!-- Logo 图片 -->
                <el-menu-item index="logo">
                    <!--                    <img src="/img/fatherfocode.png" class="logo" href="#"/>-->
                    <img src="../static/img/fatherfocode.png" class="logo" href="#"/>
                </el-menu-item>

                <!-- 其他菜单项 -->
                <el-menu-item index="1"><a href="/code/index.html" style="text-decoration:none;">首页</a></el-menu-item>
                <el-menu-item index="2"><a href="/code/data_source.html" style="text-decoration:none;">数据源</a>
                </el-menu-item>
                <el-menu-item index="3"><a href="/code/generate.html" style="text-decoration:none;">生成器</a>
                </el-menu-item>
                <el-menu-item index="4">联系我们</el-menu-item>
            </el-menu>

        </el-header>
        <el-main height="600px">
            <el-row>
                <el-col :span="6">
                    <div>
                        <el-tree :data="data"
                                 :props="defaultProps"
                                 @node-contextmenu="rightClick"
                                 @node-click="treeNodeClick">
                        </el-tree>
                        <context-menu ref="contextMenu"></context-menu>
                    </div>
                </el-col>
                <el-col :span="18">
                    <div>
                        <prism-editor class="my-editor height-200" v-model="code" :highlight="highlighter"
                                      line-numbers></prism-editor>
                    </div>
                    <div>

                    </div>
                </el-col>

            </el-row>
        </el-main>
        <el-footer>
            <p>站长： jerry mouse <i class="el-icon-document-delete"></i> <a href="mailto:3431193795@qq.com">意见反馈</a>
            </p>
            <p>版权所有：jerry mouse</p>
        </el-footer>
</div>
</body>
<!-- import Vue before Element -->
<script src="https://unpkg.com/vue@2/dist/vue.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<!-- Prism Editor -->
<script src="https://unpkg.com/vue-prism-editor"></script>


<!-- custom highlighter: -->
<script src="https://unpkg.com/prismjs/prism.js"></script>
<script src="../static/js/context-menu.js"></script>

<script>
    new Vue({
        el: '#app',
        data() {
            return {
                activeIndex: '2',
                code: "SELECT * FROM data WHERE id=12323",
                data: [{
                    label: '一级 1',
                    children: [{
                        label: '二级 1-1',
                        children: [{
                            label: '三级 1-1-1'
                        }]
                    }]
                }, {
                    label: '一级 2',
                    children: [{
                        label: '二级 2-1',
                        children: [{
                            label: '三级 2-1-1'
                        }]
                    }, {
                        label: '二级 2-2',
                        children: [{
                            label: '三级 2-2-1'
                        }]
                    }]
                }, {
                    label: '一级 3',
                    children: [{
                        label: '二级 3-1',
                        children: [{
                            label: '三级 3-1-1'
                        }]
                    }, {
                        label: '二级 3-2',
                        children: [{
                            label: '三级 3-2-1'
                        }]
                    }]
                }],
                defaultProps: {
                    children: 'children',
                    label: 'label'
                }
            }
        },
        methods: {
            highlighter(code) {
                // js highlight example
                return Prism.highlight(code, Prism.languages.js, "sql");
            },
            rightClick(e, data, node) {
                console.log(e, data, node)
                this.$refs.contextMenu.menuShow = false // 先把模态框关死，目的是 第二次或者第n次右键鼠标的时候 它默认的是true
                this.$refs.contextMenu.menuShow = true
                this.$refs.contextMenu.table_name = data
                e.preventDefault() //关闭浏览器右键默认事件
                this.rightMenu = { top: e.pageY + 'px', left: e.pageX + 'px' }
                document.addEventListener('click',(ev)=>{
                    // ev.stopImmediatePropagation()
                    if(ev.target!==document.querySelector('.el-menu-item.is-active')){
                        this.foo()
                    }
                })

            },
            foo() {
                // 取消鼠标监听事件 菜单栏
                this.$refs.contextMenu.menuShow = false
                document.removeEventListener('click', this.foo) // 关掉监听，
            },
            treeNodeClick(){
                this.foo()
            },
        }
    });
</script>
<style>
    .height-200 {
        height: 200px
    }

    .my-editor {
        /* we dont use `language-` classes anymore so thats why we need to add background and text color manually */
        background: #2d2d2d;
        color: #ccc;

        /* you must provide font-family font-size line-height. Example:*/
        font-family: Fira code, Fira Mono, Consolas, Menlo, Courier, monospace;
        font-size: 14px;
        line-height: 1.5;
        padding: 5px;
    }

    /* optional class for removing the outline */
    .prism-editor__textarea:focus {
        outline: none;
    }

    .tree_rightmenu {
        position: fixed;
        width: 120px;
        border: 1px solid rgba(0, 0, 0, 0.15);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
        z-index: 1000;
    }
</style>
</html>
